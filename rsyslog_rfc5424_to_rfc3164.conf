template(name="rfc3164" type="string"
    string="<%PRI%>%TIMESTAMP:::date-rfc3164% %HOSTNAME% %syslogtag%%msg%\n"
)

template(name="rfc3164_with_colon" type="string"
  string="<%PRI%>%TIMESTAMP:::date-rfc3164% %HOSTNAME% %syslogtag:R,ERE,1,BLANK:(.*) %msg:::sp-if-no-1st-sp%%msg:::drop-last-lf%\n")


if $syslogfacility-text == 'kern' then /var/log/kern.log;rfc3164
    
 #This is just an example of how to convert an RFC5424 log message to an RFC3164 log message using an rsyslog template. You may need to modify the template and the log message filtering rules to match your specific requirements.
